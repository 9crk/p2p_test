P2P研究总结

1.P2P是什么？
  内网两个设备通过路由器直接进行连接
  数据无需经过服务器，大量减轻了服务器负载
  服务器仅在双方建立连接的时候参与信令交换
  仅支持UDP，所以在直接通信时，需要解决数据可靠性问题

2.P2P不是100%可以成功的
  这取决于路由器（网关）的策略，将网络分为2类：可以穿越和不可穿越
  A对服务器S1发送UDP的时候，路由器使用n端口发给S1
  A不关闭socket，向服务器S2发送UDP的时候，路由器仍然使用n端口发给S2
  这样的路由器就是可以穿越的
  如果A发给S2时，路由器采用的是另一个端口n2发给S2
  这样的路由器就是不可穿越的
  （注：不可穿越的网络称为SymmetricNAT或对称网络，一般见于企业大型局域网或城中村网络内）

3.STUN和TURN
  STUN服务器：就是一个告诉内网设备其外网 IP:port 是多少的服务器，没有其他作用
  TURN服务器：P2P打洞失败时，用来转发数据的

4.开发难度：
  这是一个简单的打洞服务器和客户端例子https://github.com/9crk/p2p_test
     难点：打通后udp数据的可靠传输／无法打通时的策略：猜端口+转发
       如果采用coturn，需要熟悉其信令协议和安全机制，自己开发一套turn和stun也很简单，开发任务主要集中在客户端/设备上。
       现成客户端：PJSIP libjingle PJNATH等，但都太过复杂，且都是针对特定应用的，不建议使用。另外，不适合用于RTOS设备。
